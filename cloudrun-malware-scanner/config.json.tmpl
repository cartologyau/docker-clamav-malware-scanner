{
  "comments": [
    "Configuration file for malware-scanner service.",
    "----",
    "",
    "'buckets' is a list of objects specifying source/destination buckets for scanning, allowing the service to handle multiple buckets",
    "Each object must have the 3 properties 'unscanned', 'clean' and 'quarantined', specifying the bucket names to use.",
    "",
    "'ClamCvdMirrorBucket' is a GCS bucket used to mirror the clamav database definition files to prevent overloading the Clam servers",
    "and being rate limited/blacklisted. Its contents are maintained by the updateCvdMirror.sh script",
    "",
    "Shell environmental variable substitution is supported in this file.",
    "At runtime, it will be copied to /etc",
    "",
    "'fileExclusionPatterns' is a list of regular expressions. Files matching any",
    "of these patterns will be skipped during scanning. NOTE: These files will remain",
    "in the 'unscanned' bucket and will need to be tidied and/or managed separately.",
    "Regular expressions can be expressed as simple strings",
    "or as an array of 2 strings,  the pattern and regexp flags, such as 'i' for case insensitive matching",
    ""
    "",
    "Example:",
    "",
    "  'fileExclusionPatterns: [",
    "    '\\.filepart$',  (Ignore files ending in '.filepart')",
    "    '^ignore_me.*\\.txt$',  (Ignore files starting with 'ignore_me' and ending with '.txt')",
    "    [ '\\.tmp$', 'i' ], (Case insensitive match for files ending in .TMP, .tmp, .TmP etc)",
    "  ]",
    "",
    "Reference and Cheat sheet for regular expressions:",
    "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Regular_expressions",
    "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_expressions/Cheatsheet",
    "",
    "As an alternative to including this file in the container the contents can be passed as an enviroment variable CONFIG_JSON on",
    "Cloud Run startup",
    "",
    "Note: This comments property is optional and can be removed."
  ],
  "buckets": [
    {
      "unscanned": "unscanned-bucket-name",
      "clean": "clean-bucket-name",
      "quarantined": "quarantined-bucket-name"
    }
  ],
  "ClamCvdMirrorBucket": "cvd-mirror-bucket-name",
  "fileExclusionPatterns": [],
  "ignoreZeroLengthFiles": false
}
